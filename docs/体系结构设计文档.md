# 软件体系结构文档模板

## 文档修改历史

| 修改人员 | 日期 | 修改原因 | 版本号 |
| :------: | ---- | -------- | ------ |
| Agent_67  |   2019.5.29   |     初始化     |   v0.0     |
|          |      |          |        |

## 目录



## 引言

### 编制目的



### 词汇表

| 词汇名称 | 词汇含义 | 备注 |
| :------: | -------- | ---- |
|          |          |      |



### 参考资料



## 产品概述



## 逻辑视图

- 处理静态设计模型

  - 描述并绘制设计方案、逻辑表达

- 示意图

  - 注意：逻辑表达需要更加细化

  

## 组合视图

### 开发包图

- 表示软件组件在开发时环境中的静态组织
  - 描述开发包以及相互间的依赖
  - 绘制开发包图
    - 开发包图类似上述示意图画法

|     开发（物理）包     | 依赖的其他开发包                              |
| :-------------: | :-------------------------------------------: |
|     userui      | usercon,vo |
| usercon | userblservice,vo |
| userblservice |  |
| userbl | userdataservice,po,vo,cardbl |
| userdataservice | po |
| userdata | mybatis,po |
|     salesui      | salescon,vo |
| salescon | salesblservice,vo |
| salesblservice |  |
| salesbl | salesdataservice,po,vo,userbl,schedulebl,cardbl |
| salesdataservice | po |
| salesdata | mybatis,po |



### 运行时进程

- 表示软件在运行时进程间的交互，描述系统的动态结构

  - 绘制进程图

- 示意图：


### 物理部署

- 处理如何将软件组件映射到硬件基础设施
  - 绘制部署图
- 示意图

![icon](http://assets.processon.com/chart_image/5ae5be27e4b039625af793c0.png?_=1554259679134)

## 5.架构设计

- 描述功能分解和如何在不同的层中安排软件模块
  - 描述架构中的对象，包含架构图
  - 描述组件接口信息
    - 包括：语法、前置条件、后置条件

### 5.1 模块职责

- 模块视图
- 各层职责

|     层     | 职责     |
| :--------: | -------- |
| 用户界面层 | 展示界面 |

- 层之间调用接口

| 接口 | 服务调用方   | 服务提供方       |
| :--: | ------------ | ---------------- |
|      | 客户端展示层 | 客户端业务逻辑层 |



### 5.2 用户界面层分解

#### 5.2.1 职责

用户界面层模块的职责如表4所示
<div>
    <table>
        <caption style="font-weight: bold">表4 用户界面层模块的职责<caption>
        <hr>
        <tr>
        	<td><strong>模块</strong></td>
            <td><strong>职责</strong></td>
        </tr>
        <tr>
        	<td>UserUI</td>
            <td>负责登录、注册、观众主界面、管理员主界面的显示和发送请求</td>
        </tr>
        <tr>
        	<td>SalesUI</td>
            <td>负责购票、退票界面，管理退票界面的现实和发送请求</td>
        </tr>
    </table>
</div>

#### 5.2.2 接口规范

用户界面层的接口规范如表5，6所示

<div>
    <table>
        <caption><strong>表5 userui模块接口规范</strong><caption>
        <hr/>
        <caption><strong>需要的服务（需接口）</strong><caption>
        <tr>
            <td><strong>服务名</strong></td>
            <td><strong>服务</strong></td>
        </tr>
        <tr>
            <td>UserController.login(UserForm userForm, HttpSession session)</td>
            <td>登录系统，建立会话</td>
        </tr>
        <tr>
            <td>UserController.registerAccount(UserForm userForm)</td>
            <td>注册系统账号</td>
        </tr>
        <tr>
            <td>UserController.logOut(HttpSession session)</td>
            <td>退出登录，结束回话</td>
        </tr>
        <tr>
            <td>UserController.checkPassword(String rawPassword, HttpSession session)</td>
            <td>验证账号密码</td>
        </tr>
        <tr>
            <td>UserController.editPassword(UserForm userForm)</td>
            <td>修改账号密码</td>
        </tr>
        <tr>
            <td>UserController.getAdaptableRoles(Integer level)</td>
            <td>获取当前身份等级可修改的影院角色</td>
        </tr>
        <tr>
            <td>UserController.deleteRole(Integer id)</td>
            <td>删除影院角色</td>
        </tr>
        <tr>
            <td>UserController.editRole(RoleVO form)</td>
            <td>修改影院角色信息</td>
        </tr>
        <tr>
            <td>UserController.addRole(RoleVO form)</td>
            <td>修改影院角色</td>
        </tr>
    </table>
</div>

<div>
    <table>
        <caption><strong>表6 salesui模块接口规范</strong><caption>
        <hr/>
        <caption><strong>需要的服务（需接口）</strong><caption>
        <tr>
            <td><strong>服务名</strong></td>
            <td><strong>服务</strong></td>
        </tr>
        <tr>
            <td>SalesController.buyTicketByVIPCard(TicketAndCouponVO ticketAndCouponVO)</td>
            <td>使用会员卡购票</td>
        </tr>
        <tr>
            <td>SalesController.lockSeat(TicketForm ticketForm)</td>
            <td>未付款时提供锁座服务</td>
        </tr>
        <tr>
            <td>SalesController.buyTicket(TicketAndCouponVO ticketAndCouponVO)</td>
            <td>购票</td>
        </tr>
        <tr>
            <td>SalesController.getTicketByUserId(int userId)</td>
            <td>通过用户id获取用户买过的电影票</td>
        </tr>
        <tr>
            <td>SalesController.getOccupiedSeats(int scheduleId)</td>
            <td>通过排片id获取被锁座位</td>
        </tr>
        <tr>
            <td>SalesController.getTicketByUserId(int userId)deleteTicket(int ticketId)</td>
            <td>删除电影票</td>
        </tr>
        <tr>
            <td>SalesController.cancelTicket(List<Integer> ticketId)</td>
            <td>取消锁座</td>
        </tr>
        <tr>
            <td>SalesController.issueTicket(int ticketId)</td>
            <td>出票</td>
        </tr>
        <tr>
            <td>SalesController.getAllRefund()</td>
            <td>获取所有退票策略</td>
        </tr>
        <tr>
            <td>SalesController.publishRefund(RefundForm refundForm)</td>
            <td>新增退票策略</td>
        </tr>
        <tr>
            <td>SalesController.getRefundById(int refundId)</td>
            <td>获取退票策略</td>
        </tr>
        <tr>
            <td>SalesController.deleteRefund(int refundId)</td>
            <td>删除退票策略</td>
        </tr>
    </table>
</div>


### 5.3 控制层分解

#### 5.3.1 职责
控制层模块的职责如表7所示
<div>
    <table>
        <caption><strong>表7 控制层模块的职责</strong><caption>
        <hr>
        <tr>
        	<td><strong>模块</strong></td>
            <td><strong>职责</strong></td>
        </tr>
        <tr>
        	<td>UserController</td>
            <td>负责实现与用户账户相关的控制逻辑</td>
        </tr>
        <tr>
        	<td>TicketController</td>
            <td>负责实现与购票相关的控制逻辑</td>
        </tr>
    </table>
</div>

#### 5.3.2 接口规范
控制层的接口规范如表8,9所示
<div>
    <table>
        <caption><strong>表8 usercon模块的接口规范</strong><caption>
        <hr/>
        <caption><strong>提供的服务（供接口）</strong><caption>
        <tr>
            <td rowspan="4"> UserController.login </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public User login(UserForm userForm, HttpSession session)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/login")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据username查找是否存在相应的User，如果username和password相匹配，则建立session会话，最后返回登录验证的结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.registerAccount </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO registerAccount(UserForm userForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/register")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据UserForm查找是否已经存在对应的username，如果没有，则增加一条新的用户账号记录，最后返回注册的结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.logout </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO logOut(HttpSession session)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/logout")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>如果sessionId是有效的，则在session中删除sessionId对应的session记录，最后返回退出登录结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.checkPassword </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO checkPassword(String rawPassword, HttpSession session)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/user/checkPassword")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据用户输入的密码返回验证结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.editPassword </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO editPassword(UserForm userForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/user/edit/password")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据userForm查找用户的账号并修改账号密码，返回修改的结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.getAdaptableRoles </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getAdaptableRoles(Integer level)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/role/get")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>如果等级是有效的，根据等级查找并返回该等级可修改的影院角色</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.deleteRole </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO deleteRole(Integer id)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/role/delete")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>如果该id是有效的，根据id查找并删除该影院角色，返回删除结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.editRole </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO editRole(RoleVO form)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/role/edit")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>修改影院角色并返回修改结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserController.addRole </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO addRole(RoleVO form)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/role/add")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据from添加影院角色，并返回添加结果</td>
        </tr>
    </table>
<div>
<div>
    <table>
        <caption><strong>需要的服务（需接口）</strong></caption>
        <tr>
            <td><strong>服务名</strong></td>
            <td><strong>服务</strong></td>
        </tr>
        <tr>
            <td>UserBLService.registerAccount(UserForm userForm)</td>
            <td>注册账号</td>
        </tr>
        <tr>
            <td>UserBLService.login(UserForm userForm)</td>
            <td>用户登录，登录成功会将用户信息保存在session中</td>
        </tr>
        <tr>
            <td>UserBLService.checkPassword(User user, String rawPassword)</td>
            <td>检测密码是否正确</td>
        </tr>
        <tr>
            <td>UserBLService.editPassword(UserForm userForm)</td>
            <td>修改密码</td>
        </tr>
        <tr>
            <td>UserBLService.getAdaptableRoles(Integer level)</td>
            <td>获取当前身份等级可修改的影院角色(同级或更高级只可见用户名)</td>
        </tr>
        <tr>
            <td>UserBLService.deleteRole(Integer id)</td>
            <td>删除影院角色</td>
        </tr>
        <tr>
            <td>UserBLService.editRole(RoleVO form)</td>
            <td>修改角色信息</td>
        </tr>
        <tr>
            <td>UserBLService.addRole(RoleVO form)</td>
            <td>添加影院角色</td>
        </tr>
    </table>
</div>



<div>
    <table>
        <caption><strong>表9 salescon模块的接口规范</strong><caption>
        <hr/>
        <caption><strong>提供的服务（供接口）</strong><caption>
        <tr>
            <td rowspan="4"> SalesController.buyTicketByVIPCard </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO buyTicketByVIPCard(TicketAndCouponVO ticketAndCouponVO)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/ticket/vip/buy")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticket查找是否存在相应的会员卡，根据couponId查找是否存在相应的优惠券，存在则完成购买电影票流程，返回购买结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.lockSeat </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO lockSeat(TicketForm ticketForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/ticket/lockSeat")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketFrom锁座，返回锁座结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.buyTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO buyTicket(TicketAndCouponVO ticketAndCouponVO)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/ticket/buy")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketAndCouponVO查找并购买电影票，并返回购票结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.getTicketByUserId </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getTicketByUserId(int userId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td> @GetMapping("/ticket/get/{userId}")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据userId查找并返回用户买过的电影票</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.getOccupiedSeats </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getOccupiedSeats(int scheduleId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/ticket/get/occupiedSeats")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据scheduleId查找并返回该排片的锁座情况</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.cancelTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO cancelTicket(List<Integer> ticketId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/ticket/cancel")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketId查找并删除电影票，返回删除结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.deleteTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO deleteTicket(int ticketId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/ticket/delete")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketId查找并退还电影票，返回退票结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.issueTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO issueTicket(int ticketId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/ticket/issue")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketId查找并修改电影票状态为出票，返回出票结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.getAllRefund </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getAllRefund()</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/refund/all")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>获取并返回所有退票策略</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.publishRefund </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO publishRefund(RefundForm refundForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@PostMapping("/refund/add")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据refundFrom新增一条退票策略，返回新增结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.deleteRefund </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO deleteRefund(int refundId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/refund/delete")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据refundId查找并删除退票策略，返回删除结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesController.getRefundById </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getRefundById(int refundId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>@GetMapping("/refund/get")</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据refundId查找并返回退票策略</td>
        </tr>
    </table>
<div>
<div>
    <table>
        <caption><strong>需要的服务（需接口）</strong></caption>
        <tr>
            <td><strong>服务名</strong></td>
            <td><strong>服务</strong></td>
        </tr>
        <tr>
            <td>SalesBLService.addTicket(TicketForm ticketForm)</td>
            <td>锁座，添加票并将状态设为未付款</td>
        </tr>
        <tr>
            <td>SalesBLService.completeTicket(List<Integer> id, int couponId)</td>
            <td>完成购票</td>
        </tr>
        <tr>
            <td>SalesBLService.getBySchedule(int scheduleId)</td>
            <td>获得该场次的被锁座位和场次信息</td>
        </tr>
        <tr>
            <td>SalesBLService.getTicketByUser(int userId)</td>
            <td>获得用户买过的票</td>
        </tr>
        <tr>
            <td>SalesBLService.completeByVIPCard(List<Integer> id, int couponId)</td>
            <td>使用会员卡完成购票</td>
        </tr>
        <tr>
            <td>SalesBLService.cancelTicket(List<Integer> id)</td>
            <td>取消锁座</td>
        </tr>
        <tr>
            <td>SalesBLService.issueTicket(int id)</td>
            <td>出票，将票的状态改为已出票</td>
        </tr>
        <tr>
            <td>SalesBLService.getAllRefund()</td>
            <td>获取所有退票策略</td>
        </tr>
        <tr>
            <td>SalesBLService.publishRefund(RefundForm refundForm)</td>
            <td>添加一个退票策略</td>
        </tr>
        <tr>
            <td>SalesBLService.deleteRefund(int refundId)</td>
            <td>删除退票策略</td>
        </tr>
        <tr>
            <td>SalesBLService.getRefundById(int refundId)</td>
            <td>根据id获得退票策略</td>
        </tr>
    </table>
</div>

### 5.4 业务逻辑层分解

#### 5.4.1 职责
业务逻辑层的模块职责如表10所示。

<div>
    <table>
        <caption><strong>表10 业务逻辑层模块的职责</strong><caption>
        <hr>
        <tr>
        	<td><strong>模块</strong></td>
            <td><strong>职责</strong></td>
        </tr>
        <tr>
        	<td>UserBL</td>
            <td>负责实现对应的控制层需要的与用户相关的业务逻辑服务</td>
        </tr>
        <tr>
        	<td>SalesBL</td>
            <td>负责实现对应的控制层需要的与购票相关的业务逻辑服务</td>
        </tr>
    </table>
</div>


#### 5.4.2 接口规范
业务逻辑层的接口规范如表11,12所示。
<div>
    <table>
        <caption><strong>表11 userbl模块的接口规范</strong><caption>
        <hr/>
        <caption><strong>提供的服务（供接口）</strong><caption>
        <tr>
            <td rowspan="4"> UserBL.login </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public User login(UserForm userForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>userName符合输入条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据username查找是否存在相应的User，如果username和password相匹配，则建立session会话，最后返回登录验证的结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserBL.registerAccount </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO registerAccount(UserForm userForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>userFrom符合输入条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据UserForm查找是否已经存在对应的username，如果没有，则增加一条新的用户账号记录，最后返回注册的结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserBL.checkPassword </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO checkPassword(User user, String rawPassword)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>rawPassword符合输入条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据用户输入的密码返回验证结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserBL.editPassword </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO editPassword(UserForm userForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>用户账号存在</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据userForm查找用户的账号并修改账号密码，返回修改的结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserBL.getAdaptableRoles </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getAdaptableRoles(Integer level)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>输入的等级是有效等级</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>如果等级是有效的，根据等级查找并返回该等级可修改的影院角色</td>
        </tr>
        <tr>
            <td rowspan="4"> UserBL.deleteRole </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO deleteRole(Integer id)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>id符合输入条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>如果该id是有效的，根据id查找并删除该影院角色，返回删除结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserBL.editRole </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO editRole(RoleVO form)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>from符合输入条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>修改影院角色并返回修改结果</td>
        </tr>
        <tr>
            <td rowspan="4"> UserBL.addRole </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO addRole(RoleVO form)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>from符合输入条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据from添加影院角色，并返回添加结果</td>
        </tr>
    </table>
<div>
<div>
    <table>
        <caption><strong>需要的服务（需接口）</strong></caption>
        <tr>
            <td><strong>服务名</strong></td>
            <td><strong>服务</strong></td>
        </tr>
        <tr>
            <td>UserDataService.createNewAccount(String username, String password, Integer auth)</td>
            <td>注册账号</td>
        </tr>
        <tr>
            <td>UserDataService.getAccountByName( String username)</td>
            <td>根据用户名查找账号</td>
        </tr>
        <tr>
            <td>UserDataService.updatePassword(UserForm userForm)</td>
            <td>修改密码</td>
        </tr>
        <tr>
            <td>UserDataService.getCinemaRoles()</td>
            <td>获取全部影院角色</td>
        </tr>
        <tr>
            <td>UserDataService.deleteRoleById(Integer id)</td>
            <td>删除影院角色</td>
        </tr>
        <tr>
            <td>UserDataService.updateRoleById(Integer id, String username,
                       String password, Integer auth)</td>
            <td>更新角色信息</td>
        </tr>
    </table>
</div>



<div>
    <table>
        <caption><strong>表12 salesbl模块的接口规范</strong><caption>
        <hr/>
        <caption><strong>提供的服务（供接口）</strong><caption>
        <tr>
            <td rowspan="4"> SalesBL.completeByVIPCard </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO completeByVIPCard(List<Integer> id, int couponId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>id不为空</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticket查找是否存在相应的会员卡，根据couponId查找是否存在相应的优惠券，存在则完成购买电影票流程，返回购买结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.addTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO addTicket(TicketForm ticketForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>ticketFrom符合条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketFrom锁座，返回锁座结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.completeTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO completeTicket(List<Integer> id, int couponId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>id不为空</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketAndCouponVO查找并购买电影票，并返回购票结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.getTicketByUser </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getTicketByUser(int userId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>userId有效</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据userId查找并返回用户买过的电影票</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.getBySchedule </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getBySchedule(int scheduleId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>scheduleId是有效id</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据scheduleId查找并返回该排片的锁座情况</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.cancelTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO cancelTicket(List<Integer> id)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>id不为空</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketId查找并删除电影票，返回删除结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.issueTicket </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO issueTicket(int id)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>id为有效电影票id</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据ticketId查找并修改电影票状态为出票，返回出票结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.getAllRefund </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getAllRefund()</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>无</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>获取并返回所有退票策略</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.publishRefund </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO publishRefund(RefundForm refundForm)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>refundFrom符合输入条件</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据refundFrom新增一条退票策略，返回新增结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.deleteRefund </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO deleteRefund(int refundId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>refundId存在</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据refundId查找并删除退票策略，返回删除结果</td>
        </tr>
        <tr>
            <td rowspan="4"> SalesBL.getRefundById </td>
        </tr>
        <tr>
            <td><strong>语法</strong></td>
            <td>public ResponseVO getRefundById(int refundId)</td>
        </tr>
        <tr>
            <td><strong>前置条件</strong></td>
            <td>refundId存在</td>
        </tr>
        <tr>
            <td><strong>后置条件</strong></td>
            <td>根据refundId查找并返回退票策略</td>
        </tr>
    </table>
<div>
<div>
    <table>
        <caption><strong>需要的服务（需接口）</strong></caption>
        <tr>
            <td><strong>服务名</strong></td>
            <td><strong>服务</strong></td>
        </tr>
        <tr>
            <td>SalesDataService.insertTicket(Ticket ticket)</td>
            <td>添加单张电影票</td>
        </tr>
        <tr>
            <td>SalesDataService.insertTickets(List<Ticket> tickets)</td>
            <td>添加多张电影票</td>
        </tr>
        <tr>
            <td>SalesDataService.deleteTicket(int ticketId)</td>
            <td>删除电影票</td>
        </tr>
        <tr>
            <td>SalesDataService.selectTicketByUser(int userId)</td>
            <td>获得用户买过的票</td>
        </tr>
        <tr>
            <td>SalesDataService.deleteLockedTicket(int userId, int scheduleId)</td>
            <td>删除被锁座位的票</td>
        </tr>
        <tr>
            <td>SalesDataService.updateTicketState(int ticketId, int state)</td>
            <td>更新电影票状态</td>
        </tr>
        <tr>
            <td>SalesDataService.issueTicket(int id)</td>
            <td>出票，将票的状态改为已出票</td>
        </tr>
        <tr>
            <td>SalesDataService.getAllRefund()</td>
            <td>获取所有退票策略</td>
        </tr>
        <tr>
            <td>SalesDataService.publishRefund(RefundForm refundForm)</td>
            <td>添加一个退票策略</td>
        </tr>
        <tr>
            <td>SalesDataService.deleteRefund(int refundId)</td>
            <td>删除退票策略</td>
        </tr>
        <tr>
            <td>SalesDataService.getRefundById(int refundId)</td>
            <td>根据id获得退票策略</td>
        </tr>
    </table>
</div>


### 数据层分解

#### 职责

#### 接口规范



### 信息视角

- 描述数据持久化对象(PO)
  - 属性及其定义
  - 类型